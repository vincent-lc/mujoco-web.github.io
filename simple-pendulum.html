<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Simple Pendulum - MuJoCo Web Demos</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo">Mujoco Web Demos</a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">Index</a></li>
							<li class="active"><a href="simple-pendulum.html">Simple Pendulum</a></li>
							<li><a href="double-pendulum.html">Double Pendulum</a></li>
							<li><a href="spring-system.html">Spring System</a></li>
							<li><a href="rolling-ball.html">Rolling Ball</a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									<span class="date">June 2025</span>
									<h1>Simple Pendulum<br />
									Simulation</h1>
									<p>Interactive pendulum physics simulation with real-time controls</p>
								</header>
								
								<div style="width: 100%; height: 500px; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; margin: 20px 0; background: #f8f9fa; position: relative;">
									<canvas id="pendulumCanvas" width="800" height="500" style="display: block; margin: 0 auto;">
										Your browser doesn't support HTML5 Canvas.
									</canvas>
								</div>
								
								<!-- Control Panel -->
								<div style="background: #f8f9fa; border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin: 20px 0;">
									<h3 style="margin-top: 0; color: #333;">Physics Control Panel</h3>
									<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
										
										<!-- Pendulum Parameters -->
										<div>
											<h4 style="color: #555; margin-bottom: 15px;">Pendulum Parameters</h4>
											
											<div style="margin-bottom: 15px;">
												<label for="lengthSlider" style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">
													Length: <span id="lengthValue">150</span> px
												</label>
												<input type="range" id="lengthSlider" min="0" max="100" value="50" 
													   style="width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none;">
											</div>
											
											<div style="margin-bottom: 15px;">
												<label for="angleSlider" style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">
													Initial Angle: <span id="angleValue">45</span>°
												</label>
												<input type="range" id="angleSlider" min="0" max="100" value="75" 
													   style="width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none;">
											</div>
											
											<div style="margin-bottom: 15px;">
												<label for="velocitySlider" style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">
													Initial Velocity: <span id="velocityValue">0</span> rad/s
												</label>
												<input type="range" id="velocitySlider" min="0" max="100" value="50" 
													   style="width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none;">
											</div>
										</div>
										
										<!-- Environment Parameters -->
										<div>
											<h4 style="color: #555; margin-bottom: 15px;">Environment Parameters</h4>
											
											<div style="margin-bottom: 15px;">
												<label for="gravitySlider" style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">
													Gravity: <span id="gravityValue">0.5</span> px/s²
												</label>
												<input type="range" id="gravitySlider" min="0" max="100" value="25" 
													   style="width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none;">
											</div>
											
											<div style="margin-bottom: 15px;">
												<label for="dampingSlider" style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">
													Damping: <span id="dampingValue">0.995</span>
												</label>
												<input type="range" id="dampingSlider" min="0" max="100" value="90" 
													   style="width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none;">
											</div>
											
											<div style="margin-bottom: 15px;">
												<label for="bobSizeSlider" style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">
													Bob Size: <span id="bobSizeValue">25</span> px
												</label>
												<input type="range" id="bobSizeSlider" min="0" max="100" value="38" 
													   style="width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none;">
											</div>
										</div>
										
										<!-- Control Buttons -->
										<div>
											<h4 style="color: #555; margin-bottom: 15px;">Simulation Controls</h4>
											
											<button id="resetBtn" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
												Reset Simulation
											</button>
											
											<button id="pauseBtn" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
												Pause/Resume
											</button>
											
											<div style="background: #ecf0f1; padding: 10px; border-radius: 5px; font-size: 12px;">
												<strong>Current State:</strong><br>
												Energy: <span id="energyValue">0.00</span> J<br>
												Period: <span id="periodValue">0.00</span> s<br>
												Amplitude: <span id="amplitudeValue">0.00</span>°
											</div>
										</div>
									</div>
								</div>

							</section>

					</div>

				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

		<!-- Pendulum Simulation Script -->
		<script>
			// Wait for DOM to be fully loaded
			document.addEventListener('DOMContentLoaded', function() {
				// Pendulum Physics Simulation
				const canvas = document.getElementById('pendulumCanvas');
				const ctx = canvas.getContext('2d');
				
				// Parameter ranges for 0-100 scale mapping
				const PARAM_RANGES = {
					length: { min: 50, max: 430 }, // Updated max based on canvas height
					angle: { min: -90, max: 90 },
					velocity: { min: -2, max: 2 },
					gravity: { min: 0.1, max: 2.0 },
					damping: { min: 0.95, max: 1.0 },
					bobSize: { min: 10, max: 50 }
				};
				
				// Physics constants (now adjustable)
				let g = 0.5; // gravity
				let damping = 0.995; // air resistance
				let length = 150; // pendulum length
				let bobSize = 25; // bob size
				
				// Initial values for reset (separate from current simulation values)
				let initialAngle = Math.PI / 4; // initial angle
				let initialVelocity = 0; // initial velocity
				
				// Pendulum state (current simulation values)
				let angle = Math.PI / 4; // current angle
				let angularVelocity = 0; // current velocity
				let isDragging = false;
				let isPaused = false;
				let dragStartX, dragStartY;
				
				// Animation tracking
				let lastTime = 0;
				let periodStart = 0;
				let maxAmplitude = 0;
				
				// Drag tracking for velocity calculation
				let dragStartTime = 0;
				let lastDragX = 0;
				let lastDragY = 0;
				let lastDragTime = 0;
				let currentDragVelocity = 0; // Store the current drag velocity
				
				// Velocity scaling factor to make drag velocity more realistic
				const VELOCITY_SCALE = 0.008; // Scale down the calculated velocity
				
				// Clamp function to limit values between min and max
				function clamp(value, min, max) {
					return Math.min(Math.max(value, min), max);
				}
				
				// Canvas center
				const centerX = canvas.width / 2;
				const centerY = 50; // Move pivot point to top of canvas
				
				// Control panel elements
				const lengthSlider = document.getElementById('lengthSlider');
				const angleSlider = document.getElementById('angleSlider');
				const velocitySlider = document.getElementById('velocitySlider');
				const gravitySlider = document.getElementById('gravitySlider');
				const dampingSlider = document.getElementById('dampingSlider');
				const bobSizeSlider = document.getElementById('bobSizeSlider');
				const resetBtn = document.getElementById('resetBtn');
				const pauseBtn = document.getElementById('pauseBtn');
				
				// Utility functions for parameter conversion
				function percentToValue(percent, range) {
					return range.min + (percent / 100) * (range.max - range.min);
				}
				
				function valueToPercent(value, range) {
					return ((value - range.min) / (range.max - range.min)) * 100;
				}
				
				// Constrain length to prevent pendulum from going below canvas
				function constrainLength(requestedLength) {
					const maxLength = canvas.height - centerY - bobSize - 20; // Leave some margin
					return Math.min(requestedLength, maxLength);
				}
				
				// Update display values (shows initial values for sliders, current values for others)
				function updateDisplayValues() {
					// Length
					document.getElementById('lengthValue').textContent = Math.round(length);
					
					// Initial Angle (what slider represents)
					const initialAngleDegrees = initialAngle * 180 / Math.PI;
					document.getElementById('angleValue').textContent = Math.round(initialAngleDegrees);
					
					// Initial Velocity (what slider represents)
					document.getElementById('velocityValue').textContent = initialVelocity.toFixed(1);
					
					// Gravity
					document.getElementById('gravityValue').textContent = g.toFixed(1);
					
					// Damping
					document.getElementById('dampingValue').textContent = damping.toFixed(3);
					
					// Bob Size
					document.getElementById('bobSizeValue').textContent = bobSize;
				}
				
				// Update slider positions to show initial values
				function updateSliderPositions() {
					// Update angle slider to show initial angle
					const initialAngleDegrees = initialAngle * 180 / Math.PI;
					const anglePercent = valueToPercent(initialAngleDegrees, PARAM_RANGES.angle);
					angleSlider.value = Math.round(anglePercent);
					
					// Update velocity slider to show initial velocity
					const velocityPercent = valueToPercent(initialVelocity, PARAM_RANGES.velocity);
					velocitySlider.value = Math.round(velocityPercent);
				}
				
				// Calculate energy
				function calculateEnergy() {
					const height = length * (1 - Math.cos(angle));
					const potentialEnergy = g * height;
					const kineticEnergy = 0.5 * length * length * angularVelocity * angularVelocity;
					return potentialEnergy + kineticEnergy;
				}
				
				// Calculate period (approximate for small angles)
				function calculatePeriod() {
					return 2 * Math.PI * Math.sqrt(length / g);
				}
				
				// Update state display
				function updateStateDisplay() {
					const energy = calculateEnergy();
					const period = calculatePeriod();
					const amplitude = Math.abs(angle * 180 / Math.PI);
					
					document.getElementById('energyValue').textContent = energy.toFixed(2);
					document.getElementById('periodValue').textContent = period.toFixed(2);
					document.getElementById('amplitudeValue').textContent = amplitude.toFixed(1);
				}
				
				// Slider event listeners
				lengthSlider.addEventListener('input', function() {
					const percent = parseInt(this.value);
					const requestedLength = percentToValue(percent, PARAM_RANGES.length);
					length = constrainLength(requestedLength);
					updateDisplayValues();
				});
				
				angleSlider.addEventListener('input', function() {
					const percent = parseInt(this.value);
					const angleDegrees = percentToValue(percent, PARAM_RANGES.angle);
					initialAngle = (angleDegrees * Math.PI) / 180;
					updateDisplayValues();
				});
				
				velocitySlider.addEventListener('input', function() {
					const percent = parseInt(this.value);
					initialVelocity = percentToValue(percent, PARAM_RANGES.velocity);
					updateDisplayValues();
				});
				
				gravitySlider.addEventListener('input', function() {
					const percent = parseInt(this.value);
					g = percentToValue(percent, PARAM_RANGES.gravity);
					updateDisplayValues();
				});
				
				dampingSlider.addEventListener('input', function() {
					const percent = parseInt(this.value);
					damping = percentToValue(percent, PARAM_RANGES.damping);
					updateDisplayValues();
				});
				
				bobSizeSlider.addEventListener('input', function() {
					const percent = parseInt(this.value);
					bobSize = percentToValue(percent, PARAM_RANGES.bobSize);
					// Re-constrain length when bob size changes
					length = constrainLength(length);
					updateDisplayValues();
				});
				
				// Button event listeners
				resetBtn.addEventListener('click', function() {
					// Reset to initial values
					angle = initialAngle;
					angularVelocity = initialVelocity;
					isDragging = false;
					periodStart = 0;
					maxAmplitude = 0;
				});
				
				pauseBtn.addEventListener('click', function() {
					isPaused = !isPaused;
					this.textContent = isPaused ? 'Resume' : 'Pause';
					this.style.background = isPaused ? '#27ae60' : '#e74c3c';
				});
				
				// Mouse handling
				canvas.addEventListener('mousedown', function(e) {
					const rect = canvas.getBoundingClientRect();
					const mouseX = e.clientX - rect.left;
					const mouseY = e.clientY - rect.top;
					
					// Check if click is near pendulum bob
					const bobX = centerX + length * Math.sin(angle);
					const bobY = centerY + length * Math.cos(angle);
					const distance = Math.sqrt((mouseX - bobX) ** 2 + (mouseY - bobY) ** 2);
					
					if (distance < bobSize + 10) {
						isDragging = true;
						dragStartX = mouseX;
						dragStartY = mouseY;
						dragStartTime = performance.now();
						lastDragX = mouseX;
						lastDragY = mouseY;
						lastDragTime = dragStartTime;
						angularVelocity = 0;
					}
				});
				
				canvas.addEventListener('mousemove', function(e) {
					if (isDragging) {
						const rect = canvas.getBoundingClientRect();
						const mouseX = e.clientX - rect.left;
						const mouseY = e.clientY - rect.top;
						const currentTime = performance.now();
						
						// Calculate new angle
						const dx = mouseX - centerX;
						const dy = mouseY - centerY;
						angle = Math.atan2(dx, dy);
						
						// Calculate new length (distance from pivot to mouse)
						const newLength = Math.sqrt(dx * dx + dy * dy);
						// Constrain the length
						length = constrainLength(newLength);
						
						// Update angle slider to match current position
						const angleDegrees = angle * 180 / Math.PI;
						const anglePercent = valueToPercent(angleDegrees, PARAM_RANGES.angle);
						angleSlider.value = Math.round(anglePercent);
						initialAngle = angle; // Update initial angle to current position
						
						// Update length slider to match current position
						const lengthPercent = valueToPercent(length, PARAM_RANGES.length);
						lengthSlider.value = Math.round(lengthPercent);
						
						// Calculate current drag velocity
						const timeDelta = (currentTime - lastDragTime) / 1000; // Convert to seconds
						if (timeDelta > 0) {
							// Calculate the change in angle
							const dx1 = lastDragX - centerX;
							const dy1 = lastDragY - centerY;
							const angle1 = Math.atan2(dx1, dy1);
							
							const dx2 = mouseX - centerX;
							const dy2 = mouseY - centerY;
							const angle2 = Math.atan2(dx2, dy2);
							
							// Calculate angular velocity (change in angle over time)
							let angularVelocityChange = angle2 - angle1;
							
							// Handle angle wrapping (when crossing -π/π boundary)
							if (angularVelocityChange > Math.PI) {
								angularVelocityChange -= 2 * Math.PI;
							} else if (angularVelocityChange < -Math.PI) {
								angularVelocityChange += 2 * Math.PI;
							}
							
							currentDragVelocity = angularVelocityChange / timeDelta;
						}
						
						// Store current position and time for next calculation
						lastDragX = mouseX;
						lastDragY = mouseY;
						lastDragTime = currentTime;
						
						updateDisplayValues();
					}
				});
				
				canvas.addEventListener('mouseup', function(e) {
					if (isDragging) {
						// Use the current drag velocity that was calculated during movement
						// Apply scaling factor to make it more realistic
						const dragVelocity = currentDragVelocity * VELOCITY_SCALE;
						
						// Clamp the velocity between -1 and 1 rad/s for realistic behavior
						const clampedVelocity = clamp(dragVelocity, -1, 1);
						
						// Set the initial velocity based on drag speed
						angularVelocity = clampedVelocity;
						initialVelocity = clampedVelocity;
						
						// Update velocity slider to match the calculated velocity
						const velocityPercent = valueToPercent(clampedVelocity, PARAM_RANGES.velocity);
						velocitySlider.value = Math.round(velocityPercent);
						updateDisplayValues();
					}
					isDragging = false;
				});
				
				// Physics update function
				function updatePhysics(deltaTime) {
					if (!isDragging && !isPaused) {
						// Simple pendulum equation: d²θ/dt² + (g/L)sin(θ) = 0
						const angularAcceleration = -(g / length) * Math.sin(angle);
						angularVelocity += angularAcceleration * deltaTime;
						angularVelocity *= damping;
						angle += angularVelocity * deltaTime;
						
						// Track amplitude
						const currentAmplitude = Math.abs(angle * 180 / Math.PI);
						if (currentAmplitude > maxAmplitude) {
							maxAmplitude = currentAmplitude;
						}
					}
				}
				
				// Render function
				function render() {
					// Clear canvas
					ctx.fillStyle = '#f8f9fa';
					ctx.fillRect(0, 0, canvas.width, canvas.height);
					
					// Draw pendulum
					const bobX = centerX + length * Math.sin(angle);
					const bobY = centerY + length * Math.cos(angle);
					
					// Draw string
					ctx.strokeStyle = '#333';
					ctx.lineWidth = 3;
					ctx.beginPath();
					ctx.moveTo(centerX, centerY);
					ctx.lineTo(bobX, bobY);
					ctx.stroke();
					
					// Draw pivot point
					ctx.fillStyle = '#666';
					ctx.beginPath();
					ctx.arc(centerX, centerY, 8, 0, 2 * Math.PI);
					ctx.fill();
					
					// Draw pendulum bob
					ctx.fillStyle = isDragging ? '#e74c3c' : (isPaused ? '#95a5a6' : '#3498db');
					ctx.beginPath();
					ctx.arc(bobX, bobY, bobSize, 0, 2 * Math.PI);
					ctx.fill();
					
					// Draw bob outline
					ctx.strokeStyle = '#2980b9';
					ctx.lineWidth = 2;
					ctx.stroke();
					
					// Draw pause indicator
					if (isPaused) {
						ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
						ctx.fillRect(0, 0, canvas.width, canvas.height);
						ctx.fillStyle = 'white';
						ctx.font = '48px Arial';
						ctx.textAlign = 'center';
						ctx.fillText('PAUSED', canvas.width / 2, canvas.height / 2);
					}
				}
				
				// Animation loop
				function animate(currentTime) {
					const deltaTime = (currentTime - lastTime) / 16.67; // Normalize to 60 FPS
					lastTime = currentTime;
					
					updatePhysics(deltaTime);
					render();
					updateDisplayValues();
					updateStateDisplay();
					requestAnimationFrame(animate);
				}
				
				// Initialize display
				updateDisplayValues();
				
				// Start animation
				animate(0);
			});
		</script>

	</body>
</html> 